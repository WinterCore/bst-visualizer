!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var n in i)("object"==typeof exports?exports:e)[n]=i[n]}}(window,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t);const n=e=>new Promise(t=>setTimeout(t,e)),r=(e,t,i,n)=>Math.sqrt(Math.pow(e-t,2)+Math.pow(i-n,2)),o=(e,t,i,n)=>Math.atan2(i-n,e-t);class s{constructor(e,t=null,i=null,n=null){this.value=e,this.left=i,this.right=n,this.parent=t,this.height=0,this.level=0,this.extras={initialized:!1,entered:!1}}}class a{static*push(e,t,i=null,n=0){return e?(t>e.value?(yield{highlightedNode:e,info:`Inserting ${t} | ${t} is bigger than ${e.value} so we go right!`},e.right=yield*a.push(e.right,t,e,n+1)):t<e.value?(yield{highlightedNode:e,info:`Inserting ${t} | ${t} is less than ${e.value} so we go left!`},e.left=yield*a.push(e.left,t,e,n+1)):yield{highlightedNode:null,info:""},e.height=Math.max(a.height(e.left),a.height(e.right))+1,e.level=n,e):(yield{info:"",highlightedNode:null},new s(t,i))}static height(e){return e?e.height:0}static breadthFirstTraverse(e,t){if(!e)return;const i=[];for(i.push(e);i.length;){const e=i.shift();t(e),e.left&&i.push(e.left),e.right&&i.push(e.right)}}}const l=(e,t=0,i=0)=>{0===t&&0===i||a.breadthFirstTraverse(e,e=>{e.extras.dx+=t,e.extras.dy+=i,e.extras.transitioned=!1,e.extras.moveMultiplier=0})},d=(e,t)=>{let i=t.parent;const{padding:n,radius:r}=e;for(;i;){if(t.value>i.value&&t.extras.dx<=i.extras.dx){l(i.right,i.extras.dx-t.extras.dx+n+2*r),a.breadthFirstTraverse(i.right,t=>{d(e,t)});break}if(t.value<i.value&&t.extras.dx>=i.extras.dx){l(i.left,-(t.extras.dx-i.extras.dx+n+2*r)),a.breadthFirstTraverse(i.left,t=>{d(e,t)});break}i=i.parent}},u=(e,t,i=null)=>{if(t){if(t.extras.initialized){if(t.extras.entered||(t.extras.multiplier+=.06,t.extras.multiplier>1&&(t.extras.entered=!0)),!t.extras.transitioned){const{sx:e,sy:i,dx:n,dy:s,moveMultiplier:a}=t.extras;if(a>=1)return t.extras.transitioned=!0,t.extras.sx=n,t.extras.sy=s,t.extras.x=n,t.extras.y=s,void(t.moveMultiplier=0);const l=r(e,n,i,s)*a,d=o(n,e,s,i);t.extras.x=t.extras.sx+l*Math.cos(d),t.extras.y=t.extras.sy+l*Math.sin(d),t.extras.moveMultiplier+=.06}}else{t.extras.multiplier=0;const{x:n,y:r}=((e,t,i)=>{const{radius:n,padding:r,dimensions:o}=e;return i?{x:i.extras.dx+(i.left===t?-1:1)*(r+2*n),y:i.extras.dy+r+2*n}:{x:0,y:-o.height/2+r+n}})(e,t,i);t.extras.sx=n,t.extras.sy=r,t.extras.x=n,t.extras.y=r,t.extras.dx=n,t.extras.dy=r,t.extras.transitioned=!0,t.extras.moveMultiplier=0,d(e,t),(e=>{const{camera:t,tree:i}=e;a.breadthFirstTraverse(i,e=>{t.bounds.minX=Math.min(e.extras.x,t.bounds.minX),t.bounds.minY=Math.min(e.extras.y,t.bounds.minY),t.bounds.maxX=Math.max(e.extras.x,t.bounds.maxX),t.bounds.maxY=Math.max(e.extras.y,t.bounds.maxY)})})(e),t.extras.initialized=!0}u(e,t.left,t),u(e,t.right,t)}},h=(e,t,i=null)=>{if(!t)return;const{lineWidth:n,radius:o,fontSize:s,highlightedNode:a,ctx:l,colors:d}=e;if(l.save(),l.lineWidth=n,l.font=s+"pt Arial",i){l.save(),l.strokeStyle=d.connector;const e=i.extras.x-t.extras.x,n=i.extras.y-t.extras.y,s=Math.atan2(n,e),a={x:i.extras.x-o*Math.cos(s),y:i.extras.y-o*Math.sin(s)},u=r(i.extras.x,t.extras.x,i.extras.y,t.extras.y)-2*o,h={x:a.x+u*t.extras.multiplier*Math.cos(s+Math.PI),y:a.y+u*t.extras.multiplier*Math.sin(s+Math.PI)};l.beginPath(),l.moveTo(a.x,a.y),l.lineTo(h.x,h.y),l.stroke(),l.restore()}let{x:u,y:c}=t.extras;if(l.fillStyle=d.nodeBackground,l.strokeStyle=t===a?d.nodeBorderHighlight:d.nodeBorder,l.beginPath(),l.arc(u,c,t.extras.multiplier*o,0,2*Math.PI),l.stroke(),l.fill(),l.fillStyle=t===a?d.nodeTextHighlight:d.nodeText,t.extras.entered){const e=l.measureText(t.value);l.fillText(t.value,u-e.width/2,c+l.measureText("M").width/2-2)}l.restore(),h(e,t.left,t),h(e,t.right,t)};const c=document.querySelector("#canvas"),x={canvas:c,ctx:c.getContext("2d"),headsup:{curPos:{},nextPos:{},transitioned:!0,initialized:!1,multiplier:0},delay:2e3,highlightedNode:null,info:"",dimensions:{width:window.innerWidth,height:window.innerHeight},tree:null,mouse:{downPos:{x:0,y:0},oldCamera:{x:0,y:0},isDown:!1},camera:{x:0,y:0,zoom:1,bounds:{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0}},colors:{nodeBorder:"black",nodeText:"black",nodeBorderHighlight:"red",nodeTextHighlight:"red",nodeBackground:"white",connector:"black",headsupBackground:"white",headsupColor:"red"},radius:30,padding:20,fontSize:14,lineWidth:5,inserting:!1},m=()=>{const{dimensions:{width:e,height:t},camera:i,highlightedNode:n,headsup:s,ctx:a}=x,l=e/2,d=t/2;a.save(),a.translate(l+i.x,d+i.y),a.scale(i.zoom,i.zoom),a.clearRect(100*-l,100*-d,200*e,200*t),u(x,x.tree),h(x,x.tree),n?((e=>{const{highlightedNode:t,headsup:i}=e,{x:n,y:r}=t.extras;if(!i.initialized)return i.curPos={x:n,y:r},i.nextPos={x:n,y:r},i.initialized=!0,void(i.transitioned=!0);i.transitioned?(i.nextPos={x:n,y:r},i.transitioned=!1,i.multiplier=0):(i.multiplier>=1&&(i.curPos={...i.nextPos},i.transitioned=!0),i.multiplier=Math.min(i.multiplier+.1,1))})(x),(e=>{const{radius:t,headsup:i,fontSize:n,ctx:s,info:a,lineWidth:l,colors:d}=e,{nextPos:{x:u,y:h},curPos:{x:c,y:x}}=i,m=r(u,c,h,x)*i.multiplier,y=o(u,c,h,x),g=m*Math.cos(y),f=m*Math.sin(y);s.font=.8*n+"pt Arial",s.save();const{width:p}=s.measureText(a),{width:v}=s.measureText("M");s.fillStyle=d.headsupBackground,s.fillRect(c+g+t+10,x+f-v/2-10,p+20,v+10),s.fillStyle=d.headsupColor,s.fillText(a,c+g+t+20,x+f),s.strokeStyle=d.headsupColor,s.lineWidth=l;const w=c+g,b=x+f-t-20;s.beginPath(),s.moveTo(w,b),s.lineTo(w,b-50),s.stroke(),s.beginPath(),s.moveTo(w,b+10),s.lineTo(w-10,b-5),s.lineTo(w+10,b-5),s.fill(),s.restore()})(x)):s.initialized=!1,a.restore(),window.requestAnimationFrame(m)};!function(e){const t=document.querySelector("#insert"),i=document.querySelector("#delay"),r=document.querySelector("#random"),o=document.querySelector("#help"),s=document.querySelector("#download-link");i.value=e.delay;const l=()=>{const{dimensions:t,canvas:i}=e;t.width=window.innerWidth,t.height=window.innerHeight,i.width=t.width,i.height=t.height};async function d(e,t){const i=a.push(e.tree,t);let r=i.next();for(;!r.done;){const{highlightedNode:t,info:o}=r.value;e.highlightedNode=t,e.info=o,e.highlightedNode&&await n(e.delay),r=i.next()}return r.value}window.addEventListener("resize",l),l(),canvas.addEventListener("mousedown",({clientX:t,clientY:i})=>{const{mouse:n,camera:r,canvas:o}=e;n.downPos.x=t,n.downPos.y=i,n.oldCamera.x=r.x,n.oldCamera.y=r.y,n.isDown=!0,o.style.cursor="grabbing"}),window.addEventListener("mouseup",()=>{const{mouse:t,canvas:i}=e;t.isDown=!1,i.style.cursor="grab"}),window.addEventListener("keydown",({key:t})=>{const{camera:i}=e;switch(t){case"ArrowUp":i.zoom+=.05;break;case"ArrowDown":i.zoom=Math.max(i.zoom-.05,0)}}),window.addEventListener("mousemove",({clientX:t,clientY:i})=>{const{mouse:n,tree:r,camera:o}=e;if(n.isDown&&r){const e=t-n.downPos.x+n.oldCamera.x,r=i-n.downPos.y+n.oldCamera.y;o.x=e,o.y=r}}),t.parentNode.querySelector("button").addEventListener("click",()=>{const{value:i}=t;e.inserting||i.length&&!Number.isNaN(+i)&&(e.inserting=!0,d(e,+i).then(t=>{e.tree=t,e.inserting=!1}).catch(console.log),t.value="")}),i.parentNode.querySelector("button").addEventListener("click",()=>{const{value:t}=i;t.length&&!Number.isNaN(+t)&&(e.delay=+t)}),r.addEventListener("click",async()=>{e.inserting||(e.inserting=!0,d(e,Math.floor(1e3*Math.random())).then(t=>{e.tree=t,e.inserting=!1}).catch(console.log))}),document.querySelector("#close-help").addEventListener("click",()=>{o.style.display="none"}),document.querySelector("#open-help").addEventListener("click",()=>{o.style.display="block"}),document.querySelector("#download").addEventListener("click",()=>{if(!e.tree)return;const{camera:t,radius:i,padding:n,dimensions:r,canvas:o}=e,a=t.zoom,l={x:t.x,y:t.y},d=2*(i+n);t.zoom=1,t.x=-t.bounds.minX-r.width/2+d/2,t.y=-t.bounds.minY-r.height/2+d/2,o.width=t.bounds.maxX-t.bounds.minX+d,o.height=t.bounds.maxY-t.bounds.minY+d,setTimeout(()=>{const e=o.toDataURL("image/png"),i=`bst_${Date.now()}.png`;s.href=e,s.download=i,s.click(),t.zoom=a,o.width=r.width,o.height=r.height,t.x=l.x,t.y=l.y},100)})}(x),window.requestAnimationFrame(m)}])}));
//# sourceMappingURL=bundle.min.js.map